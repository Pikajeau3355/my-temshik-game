<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>UA Temshik Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@300;500;700;800&display=swap');
        
        :root {
            --primary: #5d5fef; --accent: #a5a6f6; --gold: #ffcf52;
            --bg: #0d0e12; --card-bg: #16171d;
            --success: #4ade80; --danger: #f87171;
        }

        body {
            margin: 0; background: var(--bg); color: #ffffff;
            font-family: 'Manrope', sans-serif; overflow: hidden;
            height: 100vh; display: flex; flex-direction: column;
        }

        body::before {
            content: ''; position: fixed; top: -10%; right: -10%; width: 300px; height: 300px;
            background: radial-gradient(circle, rgba(93,95,239,0.15) 0%, transparent 70%);
            z-index: -1;
        }

        .header {
            padding: 50px 25px 30px; background: rgba(13, 14, 18, 0.8);
            backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255,255,255,0.05);
            text-align: center;
        }
        .balance-label { font-size: 13px; color: #828282; font-weight: 500; margin-bottom: 8px; letter-spacing: 0.5px; }
        .balance { 
            font-size: 42px; font-weight: 800; letter-spacing: -1px;
            color: #fff; text-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        .balance span { color: var(--gold); margin-left: 5px; }

        .stats-row { display: flex; justify-content: center; gap: 12px; margin-top: 20px; }
        .badge {
            background: rgba(255,255,255,0.05); padding: 6px 14px; border-radius: 100px;
            font-size: 12px; font-weight: 700; border: 1px solid rgba(255,255,255,0.1);
        }

        .viewport { flex: 1; overflow-y: auto; padding: 25px; padding-bottom: 120px; }
        .tab { display: none; animation: fadeIn 0.4s ease-out; }
        .tab.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .section-h { font-size: 18px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        
        .chart-box {
            background: var(--card-bg); border-radius: 22px; padding: 20px;
            margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.03);
        }
        canvas { width: 100% !important; height: 130px !important; }

        .card {
            background: var(--card-bg); border-radius: 22px; padding: 20px;
            margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.03);
            display: flex; justify-content: space-between; align-items: center;
        }
        .card-info h3 { margin: 0; font-size: 16px; font-weight: 700; color: #fff; }
        .card-info p { margin: 4px 0 0; font-size: 13px; color: #828282; }

        .action-btn {
            background: var(--primary); color: white; border: none; padding: 12px 20px;
            border-radius: 16px; font-weight: 700; font-size: 14px; transition: 0.3s;
            box-shadow: 0 4px 15px rgba(93,95,239,0.3);
        }
        .action-btn:active { transform: scale(0.94); }
        .action-btn:disabled { background: #25262b; color: #555; box-shadow: none; }

        .nav {
            position: fixed; bottom: 30px; left: 25px; right: 25px;
            background: rgba(22, 23, 29, 0.95); backdrop-filter: blur(20px);
            border-radius: 24px; height: 75px; display: flex;
            justify-content: space-around; align-items: center;
            border: 1px solid rgba(255,255,255,0.08); box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; transition: 0.3s; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 24px; margin-bottom: 4px; }
        .nav-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }

        .log {
            background: rgba(0,0,0,0.2); border-radius: 18px; padding: 15px;
            font-size: 12px; height: 110px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.05);
        }
        .log-item { margin-bottom: 8px; padding-left: 12px; border-left: 2px solid var(--primary); }
    </style>
</head>
<body>

    <div class="header">
        <div class="balance-label">–î–û–°–¢–£–ü–ù–ò–ô –ë–ê–õ–ê–ù–°</div>
        <div class="balance" id="balance">0<span>‚Ç¥</span></div>
        <div class="stats-row">
            <div class="badge" id="rank-display" style="color:var(--accent)">–ù–û–í–ê–ß–û–ö</div>
            <div class="badge" id="exp-display">0 XP</div>
        </div>
    </div>

    <div class="viewport">
        <div id="tab-work" class="tab active">
            <div class="section-h">üöÄ –ê–∫—Ç—É–∞–ª—å–Ω—ñ —Ç–µ–º–∫–∏</div>
            <div id="temki-list"></div>
            <div class="section-h" style="margin-top:30px;">üßæ –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü—ñ–π</div>
            <div class="log" id="terminal"></div>
        </div>

        <div id="tab-crypto" class="tab">
            <div class="section-h">üìà –ö—Ä–∏–ø—Ç–æ-—ñ–Ω–≤–µ—Å—Ç</div>
            <div class="chart-box">
                <div id="btc-price" style="font-weight:800; color:var(--success); font-size:22px; margin-bottom:10px;">‚Ç¥ 2,800,000</div>
                <canvas id="cryptoChart" width="300" height="130"></canvas>
            </div>
            <div class="card">
                <div class="card-info">
                    <h3>Bitcoin (BTC)</h3>
                    <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span id="my-btc" style="color:#fff">0</span> BTC</p>
                </div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <button class="action-btn" onclick="tradeBtc('buy')">–ö–£–ü–ò–¢–ò 0.001</button>
                <button class="action-btn" style="background:#25262b" onclick="tradeBtc('sell')">–ü–†–û–î–ê–¢–ò 0.001</button>
                <button class="action-btn" style="grid-column: span 1; background: var(--gold); color: #000;" onclick="tradeBtc('all_buy')">–í–°–ï –í BTC</button>
                <button class="action-btn" style="grid-column: span 1; background: #fff; color: #000;" onclick="tradeBtc('all_sell')">–ü–†–û–î–ê–¢–ò –í–°–ï</button>
            </div>
        </div>

        <div id="tab-shop" class="tab">
            <div class="section-h">üèéÔ∏è –ú–∞–π–Ω–æ —Ç–∞ –∞–∫—Ç–∏–≤–∏</div>
            <div id="shop-list"></div>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showTab('work', this)">
            <span class="nav-icon">üí∏</span><span class="nav-label">–¢–µ–º–∫–∏</span>
        </div>
        <div class="nav-item" onclick="showTab('crypto', this)">
            <span class="nav-icon">üìä</span><span class="nav-label">–ö—Ä–∏–ø—Ç–∞</span>
        </div>
        <div class="nav-item" onclick="showTab('shop', this)">
            <span class="nav-icon">üè†</span><span class="nav-label">–ê–∫—Ç–∏–≤–∏</span>
        </div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let money = Number(localStorage.getItem('money')) || 1000;
        let exp = Number(localStorage.getItem('exp')) || 0;
        let btcCount = Number(localStorage.getItem('btcCount')) || 0;
        let btcPrice = 2850000;
        let priceHistory = [2850000, 2800000, 2870000, 2840000, 2860000];
        let ownedItems = JSON.parse(localStorage.getItem('ownedItems')) || [];

        function save() {
            localStorage.setItem('money', money);
            localStorage.setItem('exp', exp);
            localStorage.setItem('btcCount', btcCount);
            localStorage.setItem('ownedItems', JSON.stringify(ownedItems));
        }

        function drawChart() {
            const canvas = document.getElementById('cryptoChart');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const min = Math.min(...priceHistory);
            const max = Math.max(...priceHistory);
            const range = max - min || 1;
            ctx.beginPath();
            ctx.strokeStyle = '#4ade80';
            ctx.lineWidth = 4;
            priceHistory.forEach((p, i) => {
                const x = (i / (priceHistory.length - 1)) * canvas.width;
                const y = canvas.height - ((p - min) / range) * (canvas.height - 20) - 10;
                if(i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
            });
            ctx.stroke();
        }

        const temki = [
            { id: 1, name: "–î—Ä–æ–ø –Ω–∞ –ü—Ä–æ–º", cost: 300, min: 30, max: 200, risk: 0.1, rank: 0 },
            { id: 2, name: "–ü–µ—Ä–µ–ø—Ä–æ–¥–∞–∂ iPhone", cost: 15000, min: 1200, max: 4500, risk: 0.15, rank: 400 },
            { id: 3, name: "–ê—Ä–±—ñ—Ç—Ä–∞–∂ —Ç—Ä–∞—Ñ—ñ–∫—É", cost: 80000, min: -15000, max: 35000, risk: 0.25, rank: 2000 }
        ];

        const shop = [
            { id: 'lanos', name: "Lanos –Ω–∞ –≥–∞–∑—É", cost: 35000, bonus: "–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–¥–∞—Ç–∫—ñ–≤" },
            { id: 'bmw', name: "BMW M5 F90", cost: 350000, bonus: "+25% –¥–æ –ø—Ä–∏–±—É—Ç–∫—É" },
            { id: 'office', name: "–û—Ñ—ñ—Å –≤ IQ Center", cost: 2500000, bonus: "X2 –¥–æ—Å–≤—ñ–¥—É" }
        ];

        function showTab(name, el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + name).classList.add('active');
            el.classList.add('active');
            tg.HapticFeedback.selectionChanged();
            if(name === 'crypto') setTimeout(drawChart, 100);
        }

        function updateUI() {
            document.getElementById('balance').innerHTML = Math.floor(money).toLocaleString() + '<span>‚Ç¥</span>';
            document.getElementById('exp-display').textContent = exp + ' XP';
            document.getElementById('my-btc').textContent = btcCount.toFixed(6);
            
            const ranks = ["–ù–û–í–ê–ß–û–ö", "–°–£–Ñ–¢–û–õ–û–ì", "–ë–û–°", "–ú–ê–ì–ù–ê–¢"];
            let rIdx = Math.min(Math.floor(exp / 2000), ranks.length - 1);
            document.getElementById('rank-display').textContent = ranks[rIdx];

            const tList = document.getElementById('temki-list');
            tList.innerHTML = '';
            temki.forEach(t => {
                const locked = exp < t.rank;
                tList.innerHTML += `<div class="card">
                    <div class="card-info"><h3>${t.name} ${locked?'üîí':''}</h3><p>${locked?'–¢—Ä–µ–±–∞ '+t.rank+' XP':t.cost.toLocaleString()+' ‚Ç¥'}</p></div>
                    <button class="action-btn" onclick="work(${t.id})" ${money<t.cost||locked?'disabled':''}>–í–û–†–í–ê–¢–ò–°–¨</button>
                </div>`;
            });

            const sList = document.getElementById('shop-list');
            sList.innerHTML = '';
            shop.forEach(i => {
                const owned = ownedItems.includes(i.id);
                sList.innerHTML += `<div class="card">
                    <div class="card-info"><h3>${i.name}</h3><p>${owned?'–ü–†–ò–î–ë–ê–ù–û':i.cost.toLocaleString()+' ‚Ç¥'}</p></div>
                    <button class="action-btn" onclick="buyItem('${i.id}')" ${money<i.cost||owned?'disabled':''}>${owned?'–í–õ–ê–°–ù–Ü–°–¢–¨':'–ö–£–ü–ò–¢–ò'}</button>
                </div>`;
            });
            save();
        }

        function tradeBtc(type) {
            const step = 0.001;
            const cost = btcPrice * step;

            if(type === 'buy') {
                if(money >= cost) {
                    money -= cost; btcCount += step;
                    addLog(`–ö—É–ø–ª–µ–Ω–æ ${step} BTC`, 'var(--success)');
                } else tg.HapticFeedback.notificationOccurred('error');
            } 
            else if(type === 'sell') {
                if(btcCount >= step) {
                    money += cost; btcCount -= step;
                    addLog(`–ü—Ä–æ–¥–∞–Ω–æ ${step} BTC`, 'var(--danger)');
                } else tg.HapticFeedback.notificationOccurred('error');
            }
            else if(type === 'all_buy') {
                if(money > 10) {
                    let buyAmount = money / btcPrice;
                    btcCount += buyAmount;
                    addLog(`–í—Å—ñ ‚Ç¥ –≤ BTC (+${buyAmount.toFixed(5)})`, 'var(--gold)');
                    money = 0;
                }
            }
            else if(type === 'all_sell') {
                if(btcCount > 0) {
                    let profit = btcCount * btcPrice;
                    money += profit;
                    addLog(`–ü—Ä–æ–¥–∞–Ω–æ –≤—Å–µ: +${Math.floor(profit)} ‚Ç¥`, '#fff');
                    btcCount = 0;
                }
            }
            tg.HapticFeedback.impactOccurred('medium');
            updateUI();
        }

        setInterval(() => {
            let change = (Math.random() - 0.5) * 60000;
            btcPrice += change;
            priceHistory.push(btcPrice);
            if(priceHistory.length > 20) priceHistory.shift();
            const el = document.getElementById('btc-price');
            if(el) {
                el.textContent = '‚Ç¥ ' + Math.floor(btcPrice).toLocaleString();
                el.style.color = change > 0 ? 'var(--success)' : 'var(--danger)';
                drawChart();
            }
        }, 4000);

        function work(id) {
            const t = temki.find(x => x.id === id);
            money -= t.cost;
            if (Math.random() < t.risk) {
                addLog(`–°—Ö–µ–º–∞ –ø—Ä–æ–≤–∞–ª–µ–Ω–∞: ${t.name}`, 'var(--danger)');
                tg.HapticFeedback.notificationOccurred('error');
            } else {
                let p = Math.floor(Math.random() * (t.max - t.min + 1)) + t.min;
                if(ownedItems.includes('bmw')) p = Math.floor(p * 1.25);
                money += (t.cost + p); 
                exp += ownedItems.includes('office') ? 50 : 25;
                addLog(`–ü—Ä–æ—Ñ—ñ—Ç: +${p} ‚Ç¥`, 'var(--success)');
                tg.HapticFeedback.notificationOccurred('success');
            }
            updateUI();
        }

        function buyItem(id) {
            const item = shop.find(i => i.id === id);
            if (money >= item.cost) {
                money -= item.cost;
                ownedItems.push(id);
                updateUI();
            }
        }

        function addLog(msg, col) {
            const l = document.getElementById('terminal');
            if(l) l.insertAdjacentHTML('afterbegin', `<div class="log-item" style="border-color:${col}">${msg}</div>`);
        }

        updateUI();
    </script>
</body>
</html>
