<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üé∞ Lucky Casino</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Montserrat', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .gold-gradient {
            background: linear-gradient(135deg, #f5af19 0%, #f12711 50%, #f5af19 100%);
            background-size: 200% 200%;
            animation: shimmer 3s ease infinite;
        }
        
        .gold-text {
            background: linear-gradient(135deg, #ffd700, #ffaa00, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .slot-reel {
            background: linear-gradient(180deg, #2d2d44 0%, #1a1a2e 50%, #2d2d44 100%);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.8);
        }
        
        .slot-symbol {
            font-size: 2.5rem;
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
        }
        
        @keyframes spin {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100%); }
        }
        
        .spinning .slot-symbol {
            animation: spin 0.1s linear infinite;
        }
        
        .glow-button {
            box-shadow: 0 0 20px rgba(245, 175, 25, 0.4), 
                        0 0 40px rgba(245, 175, 25, 0.2),
                        inset 0 1px 0 rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .glow-button:hover {
            box-shadow: 0 0 30px rgba(245, 175, 25, 0.6), 
                        0 0 60px rgba(245, 175, 25, 0.3),
                        inset 0 1px 0 rgba(255,255,255,0.3);
            transform: scale(1.02);
        }
        
        .glow-button:active {
            transform: scale(0.98);
        }
        
        .card {
            background: linear-gradient(145deg, #252542 0%, #1e1e35 100%);
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }
        
        .balance-card {
            background: linear-gradient(145deg, #2a2a4a 0%, #1f1f38 100%);
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        @keyframes jackpot {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes coins {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .coin {
            position: fixed;
            font-size: 2rem;
            animation: coins 2s ease-in forwards;
            pointer-events: none;
            z-index: 100;
        }
        
        .win-animation {
            animation: jackpot 0.3s ease infinite;
        }
        
        .tab-active {
            background: linear-gradient(135deg, #f5af19 0%, #f12711 100%);
            color: white;
        }
        
        .roulette-wheel {
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: conic-gradient(
                #e53935 0deg 10deg, #1a1a2e 10deg 20deg,
                #e53935 20deg 30deg, #1a1a2e 30deg 40deg,
                #e53935 40deg 50deg, #1a1a2e 50deg 60deg,
                #e53935 60deg 70deg, #1a1a2e 70deg 80deg,
                #e53935 80deg 90deg, #1a1a2e 90deg 100deg,
                #e53935 100deg 110deg, #1a1a2e 110deg 120deg,
                #e53935 120deg 130deg, #1a1a2e 130deg 140deg,
                #e53935 140deg 150deg, #1a1a2e 150deg 160deg,
                #e53935 160deg 170deg, #1a1a2e 170deg 180deg,
                #e53935 180deg 190deg, #1a1a2e 190deg 200deg,
                #e53935 200deg 210deg, #1a1a2e 210deg 220deg,
                #e53935 220deg 230deg, #1a1a2e 230deg 240deg,
                #e53935 240deg 250deg, #1a1a2e 250deg 260deg,
                #e53935 260deg 270deg, #1a1a2e 270deg 280deg,
                #e53935 280deg 290deg, #1a1a2e 290deg 300deg,
                #e53935 300deg 310deg, #1a1a2e 310deg 320deg,
                #e53935 320deg 330deg, #1a1a2e 330deg 340deg,
                #4caf50 340deg 350deg, #1a1a2e 350deg 360deg
            );
            box-shadow: 0 0 0 10px #ffd700, 0 0 0 15px #1a1a2e, 0 0 40px rgba(255,215,0,0.3);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }
        
        .nav-item {
            transition: all 0.3s ease;
        }
        
        .nav-item.active {
            color: #ffd700;
            transform: scale(1.1);
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }
        
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            opacity: 0.5;
            animation: twinkle 2s ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }
        
        .history-item {
            border-left: 3px solid;
        }
        
        .history-win { border-color: #4caf50; }
        .history-lose { border-color: #e53935; }
    </style>
</head>
<body class="text-white pb-24">
    <!-- Stars Background -->
    <div class="stars" id="stars"></div>
    
    <!-- Header -->
    <header class="relative z-10 p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full gold-gradient flex items-center justify-center text-2xl">
                üé∞
            </div>
            <div>
                <h1 class="text-xl font-bold gold-text">Lucky Casino</h1>
                <p class="text-xs text-gray-400">–£–¥–∞—á–∏ –≤ –∏–≥—Ä–µ!</p>
            </div>
        </div>
        <div class="balance-card rounded-xl px-4 py-2">
            <p class="text-xs text-gray-400">–ë–∞–ª–∞–Ω—Å</p>
            <p class="text-lg font-bold gold-text" id="balance">10,000 üíé</p>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="relative z-10 px-4">
        <!-- Tabs -->
        <div class="flex gap-2 mb-6 bg-[#1a1a2e] rounded-2xl p-1">
            <button onclick="showTab('slots')" id="tab-slots" class="tab-active flex-1 py-3 rounded-xl font-semibold transition-all">
                üé∞ –°–ª–æ—Ç—ã
            </button>
            <button onclick="showTab('roulette')" id="tab-roulette" class="flex-1 py-3 rounded-xl font-semibold transition-all text-gray-400">
                üé° –†—É–ª–µ—Ç–∫–∞
            </button>
            <button onclick="showTab('history')" id="tab-history" class="flex-1 py-3 rounded-xl font-semibold transition-all text-gray-400">
                üìú –ò—Å—Ç–æ—Ä–∏—è
            </button>
        </div>
        
        <!-- Slots Game -->
        <div id="slots-game" class="game-section">
            <div class="card rounded-3xl p-6 mb-6">
                <div class="text-center mb-4">
                    <span class="text-sm text-gray-400">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –≤—ã–∏–≥—Ä—ã—à–∞</span>
                    <div class="flex justify-center gap-4 mt-2 text-sm">
                        <span>3Ô∏è‚É£ = x10</span>
                        <span>üçí = x5</span>
                        <span>üçã = x3</span>
                    </div>
                </div>
                
                <!-- Slot Machine -->
                <div class="flex justify-center gap-3 mb-6">
                    <div class="slot-reel w-24 h-28 rounded-2xl flex items-center justify-center overflow-hidden" id="reel1">
                        <span class="slot-symbol">üçí</span>
                    </div>
                    <div class="slot-reel w-24 h-28 rounded-2xl flex items-center justify-center overflow-hidden" id="reel2">
                        <span class="slot-symbol">üçã</span>
                    </div>
                    <div class="slot-reel w-24 h-28 rounded-2xl flex items-center justify-center overflow-hidden" id="reel3">
                        <span class="slot-symbol">üçá</span>
                    </div>
                </div>
                
                <!-- Win Display -->
                <div id="win-display" class="text-center mb-4 h-8">
                    <span class="text-2xl font-bold gold-text"></span>
                </div>
                
                <!-- Bet Controls -->
                <div class="flex items-center justify-center gap-4 mb-6">
                    <button onclick="changeBet(-100)" class="w-12 h-12 rounded-full bg-[#2d2d44] text-2xl font-bold hover:bg-[#3d3d54] transition-all">-</button>
                    <div class="text-center">
                        <p class="text-xs text-gray-400">–°—Ç–∞–≤–∫–∞</p>
                        <p class="text-2xl font-bold" id="bet-amount">500 üíé</p>
                    </div>
                    <button onclick="changeBet(100)" class="w-12 h-12 rounded-full bg-[#2d2d44] text-2xl font-bold hover:bg-[#3d3d54] transition-all">+</button>
                </div>
                
                <!-- Spin Button -->
                <button onclick="spin()" id="spin-btn" class="w-full py-4 rounded-2xl gold-gradient glow-button text-xl font-bold text-white">
                    üé∞ –ö–†–£–¢–ò–¢–¨
                </button>
            </div>
            
            <!-- Quick Stats -->
            <div class="grid grid-cols-3 gap-3">
                <div class="card rounded-2xl p-4 text-center">
                    <p class="text-2xl">üèÜ</p>
                    <p class="text-xs text-gray-400 mt-1">–ü–æ–±–µ–¥</p>
                    <p class="font-bold gold-text" id="wins-count">0</p>
                </div>
                <div class="card rounded-2xl p-4 text-center">
                    <p class="text-2xl">üéÆ</p>
                    <p class="text-xs text-gray-400 mt-1">–ò–≥—Ä</p>
                    <p class="font-bold" id="games-count">0</p>
                </div>
                <div class="card rounded-2xl p-4 text-center">
                    <p class="text-2xl">üí∞</p>
                    <p class="text-xs text-gray-400 mt-1">–ú–∞–∫—Å. –≤—ã–∏–≥—Ä—ã—à</p>
                    <p class="font-bold gold-text" id="max-win">0</p>
                </div>
            </div>
        </div>
        
        <!-- Roulette Game -->
        <div id="roulette-game" class="game-section hidden">
            <div class="card rounded-3xl p-6 mb-6">
                <!-- Roulette Wheel -->
                <div class="flex justify-center mb-6 relative">
                    <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-2 z-10">
                        <div class="w-0 h-0 border-l-8 border-r-8 border-t-12 border-l-transparent border-r-transparent border-t-yellow-400"></div>
                    </div>
                    <div class="roulette-wheel" id="roulette-wheel">
                        <div class="absolute inset-8 rounded-full bg-[#1a1a2e] flex items-center justify-center">
                            <span class="text-4xl" id="roulette-result">üé±</span>
                        </div>
                    </div>
                </div>
                
                <!-- Betting Options -->
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <button onclick="selectRouletteColor('red')" id="bet-red" class="py-4 rounded-xl bg-red-600 font-bold text-lg hover:bg-red-500 transition-all border-2 border-transparent">
                        üî¥ –ö—Ä–∞—Å–Ω–æ–µ x2
                    </button>
                    <button onclick="selectRouletteColor('black')" id="bet-black" class="py-4 rounded-xl bg-gray-800 font-bold text-lg hover:bg-gray-700 transition-all border-2 border-transparent">
                        ‚ö´ –ß—ë—Ä–Ω–æ–µ x2
                    </button>
                </div>
                <button onclick="selectRouletteColor('green')" id="bet-green" class="w-full py-3 rounded-xl bg-green-600 font-bold hover:bg-green-500 transition-all border-2 border-transparent mb-4">
                    üü¢ –ó–µ–ª—ë–Ω–æ–µ x14
                </button>
                
                <!-- Bet Controls -->
                <div class="flex items-center justify-center gap-4 mb-4">
                    <button onclick="changeRouletteBet(-100)" class="w-10 h-10 rounded-full bg-[#2d2d44] text-xl font-bold">-</button>
                    <div class="text-center">
                        <p class="text-xs text-gray-400">–°—Ç–∞–≤–∫–∞</p>
                        <p class="text-xl font-bold" id="roulette-bet-amount">500 üíé</p>
                    </div>
                    <button onclick="changeRouletteBet(100)" class="w-10 h-10 rounded-full bg-[#2d2d44] text-xl font-bold">+</button>
                </div>
                
                <!-- Spin Button -->
                <button onclick="spinRoulette()" id="roulette-spin-btn" class="w-full py-4 rounded-2xl gold-gradient glow-button text-xl font-bold text-white">
                    üé° –ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£
                </button>
            </div>
        </div>
        
        <!-- History -->
        <div id="history-game" class="game-section hidden">
            <div class="card rounded-3xl p-6">
                <h2 class="text-xl font-bold mb-4 gold-text">üìú –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</h2>
                <div id="history-list" class="space-y-3">
                    <p class="text-gray-400 text-center py-8">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –°—ã–≥—Ä–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∏–≥—Ä—É!</p>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-[#1a1a2e]/95 backdrop-blur-lg border-t border-yellow-500/20 px-6 py-4 z-50">
        <div class="flex justify-around items-center">
            <button onclick="showTab('slots')" class="nav-item active flex flex-col items-center gap-1" id="nav-slots">
                <span class="text-2xl">üé∞</span>
                <span class="text-xs">–°–ª–æ—Ç—ã</span>
            </button>
            <button onclick="showTab('roulette')" class="nav-item flex flex-col items-center gap-1 text-gray-400" id="nav-roulette">
                <span class="text-2xl">üé°</span>
                <span class="text-xs">–†—É–ª–µ—Ç–∫–∞</span>
            </button>
            <button onclick="addBonus()" class="nav-item flex flex-col items-center gap-1 text-gray-400" id="nav-bonus">
                <span class="text-2xl">üéÅ</span>
                <span class="text-xs">–ë–æ–Ω—É—Å</span>
            </button>
            <button onclick="showTab('history')" class="nav-item flex flex-col items-center gap-1 text-gray-400" id="nav-history">
                <span class="text-2xl">üìú</span>
                <span class="text-xs">–ò—Å—Ç–æ—Ä–∏—è</span>
            </button>
        </div>
    </nav>

    <script>
        // Telegram WebApp Init
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.setHeaderColor('#1a1a2e');
            tg.setBackgroundColor('#1a1a2e');
        }
        
        // Game State
        let balance = 10000;
        let bet = 500;
        let rouletteBet = 500;
        let selectedColor = 'red';
        let isSpinning = false;
        let wins = 0;
        let games = 0;
        let maxWin = 0;
        let history = [];
        let lastBonusTime = 0;
        
        const symbols = ['üçí', 'üçã', 'üçá', 'üçä', 'üíé', '7Ô∏è‚É£', 'üçÄ', '‚≠ê'];
        const jackpotSymbol = '7Ô∏è‚É£';
        
        // Create stars background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }
        createStars();
        
        // Update Balance Display
        function updateBalance() {
            document.getElementById('balance').textContent = balance.toLocaleString() + ' üíé';
        }
        
        // Change Bet
        function changeBet(amount) {
            bet = Math.max(100, Math.min(balance, bet + amount));
            document.getElementById('bet-amount').textContent = bet.toLocaleString() + ' üíé';
        }
        
        function changeRouletteBet(amount) {
            rouletteBet = Math.max(100, Math.min(balance, rouletteBet + amount));
            document.getElementById('roulette-bet-amount').textContent = rouletteBet.toLocaleString() + ' üíé';
        }
        
        // Slot Machine Spin
        function spin() {
            if (isSpinning || balance < bet) {
                if (balance < bet) {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! üí∏', 'error');
                }
                return;
            }
            
            isSpinning = true;
            balance -= bet;
            games++;
            updateBalance();
            
            const spinBtn = document.getElementById('spin-btn');
            spinBtn.disabled = true;
            spinBtn.textContent = 'üé∞ –ö–†–£–¢–ò–ú...';
            
            document.getElementById('win-display').innerHTML = '';
            
            const reels = [
                document.getElementById('reel1'),
                document.getElementById('reel2'),
                document.getElementById('reel3')
            ];
            
            // Add spinning class
            reels.forEach(reel => reel.classList.add('spinning'));
            
            // Generate results
            const results = [];
            for (let i = 0; i < 3; i++) {
                results.push(symbols[Math.floor(Math.random() * symbols.length)]);
            }
            
            // Force occasional wins (30% chance)
            if (Math.random() < 0.3) {
                const winSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                results[0] = winSymbol;
                results[1] = winSymbol;
                if (Math.random() < 0.3) {
                    results[2] = winSymbol;
                }
            }
            
            // Stop reels with delay
            reels.forEach((reel, index) => {
                setTimeout(() => {
                    reel.classList.remove('spinning');
                    reel.querySelector('.slot-symbol').textContent = results[index];
                    
                    if (index === 2) {
                        checkWin(results);
                    }
                }, 500 + (index * 400));
            });
        }
        
        // Check Win
        function checkWin(results) {
            let winAmount = 0;
            let message = '';
            
            if (results[0] === results[1] && results[1] === results[2]) {
                // Jackpot - all same
                if (results[0] === jackpotSymbol) {
                    winAmount = bet * 50;
                    message = 'üéâ –î–ñ–ï–ö–ü–û–¢! üéâ';
                } else if (results[0] === 'üíé') {
                    winAmount = bet * 20;
                    message = 'üíé MEGA WIN! üíé';
                } else {
                    winAmount = bet * 10;
                    message = 'üèÜ –ë–û–õ–¨–®–û–ô –í–´–ò–ì–†–´–®!';
                }
            } else if (results[0] === results[1] || results[1] === results[2] || results[0] === results[2]) {
                // Two same
                winAmount = bet * 2;
                message = '‚ú® –í—ã–∏–≥—Ä—ã—à!';
            }
            
            if (winAmount > 0) {
                balance += winAmount;
                wins++;
                maxWin = Math.max(maxWin, winAmount);
                
                document.getElementById('win-display').innerHTML = 
                    `<span class="win-animation">${message} +${winAmount.toLocaleString()} üíé</span>`;
                
                createCoinRain();
                addToHistory('slots', bet, winAmount, true);
                
                if (tg?.HapticFeedback) {
                    tg.HapticFeedback.notificationOccurred('success');
                }
            } else {
                document.getElementById('win-display').innerHTML = 
                    '<span class="text-gray-400">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑!</span>';
                addToHistory('slots', bet, 0, false);
            }
            
            updateBalance();
            updateStats();
            
            const spinBtn = document.getElementById('spin-btn');
            spinBtn.disabled = false;
            spinBtn.textContent = 'üé∞ –ö–†–£–¢–ò–¢–¨';
            isSpinning = false;
        }
        
        // Roulette
        function selectRouletteColor(color) {
            selectedColor = color;
            
            document.getElementById('bet-red').classList.remove('border-yellow-400');
            document.getElementById('bet-black').classList.remove('border-yellow-400');
            document.getElementById('bet-green').classList.remove('border-yellow-400');
            
            document.getElementById('bet-' + color).classList.add('border-yellow-400');
        }
        
        function spinRoulette() {
            if (isSpinning || balance < rouletteBet) {
                if (balance < rouletteBet) {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! üí∏', 'error');
                }
                return;
            }
            
            isSpinning = true;
            balance -= rouletteBet;
            games++;
            updateBalance();
            
            const spinBtn = document.getElementById('roulette-spin-btn');
            spinBtn.disabled = true;
            spinBtn.textContent = 'üé° –ö–†–£–¢–ò–ú...';
            
            const wheel = document.getElementById('roulette-wheel');
            const resultDisplay = document.getElementById('roulette-result');
            
            // Random result
            const randomDeg = 1800 + Math.random() * 1800;
            wheel.style.transform = `rotate(${randomDeg}deg)`;
            
            // Determine result based on final position
            setTimeout(() => {
                const colors = ['red', 'black', 'red', 'black', 'red', 'black', 'red', 'black', 
                               'red', 'black', 'red', 'black', 'red', 'black', 'red', 'black', 
                               'red', 'black', 'green', 'black'];
                const result = colors[Math.floor(Math.random() * colors.length)];
                
                const icons = { red: 'üî¥', black: '‚ö´', green: 'üü¢' };
                resultDisplay.textContent = icons[result];
                
                let winAmount = 0;
                if (result === selectedColor) {
                    const multipliers = { red: 2, black: 2, green: 14 };
                    winAmount = rouletteBet * multipliers[result];
                    balance += winAmount;
                    wins++;
                    maxWin = Math.max(maxWin, winAmount);
                    
                    showNotification(`–í—ã–∏–≥—Ä—ã—à +${winAmount.toLocaleString()} üíé`, 'success');
                    createCoinRain();
                    addToHistory('roulette', rouletteBet, winAmount, true);
                    
                    if (tg?.HapticFeedback) {
                        tg.HapticFeedback.notificationOccurred('success');
                    }
                } else {
                    showNotification('–ù–µ –ø–æ–≤–µ–∑–ª–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑', 'error');
                    addToHistory('roulette', rouletteBet, 0, false);
                }
                
                updateBalance();
                updateStats();
                
                spinBtn.disabled = false;
                spinBtn.textContent = 'üé° –ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£';
                isSpinning = false;
            }, 4000);
        }
        
        // Effects
        function createCoinRain() {
            const coins = ['üíé', 'üí∞', 'ü™ô', '‚ú®'];
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const coin = document.createElement('div');
                    coin.className = 'coin';
                    coin.textContent = coins[Math.floor(Math.random() * coins.length)];
                    coin.style.left = Math.random() * 100 + '%';
                    document.body.appendChild(coin);
                    
                    setTimeout(() => coin.remove(), 2000);
                }, i * 100);
            }
        }
        
        // Update Stats
        function updateStats() {
            document.getElementById('wins-count').textContent = wins;
            document.getElementById('games-count').textContent = games;
            document.getElementById('max-win').textContent = maxWin.toLocaleString();
        }
        
        // History
        function addToHistory(game, betAmount, winAmount, isWin) {
            const gameNames = { slots: 'üé∞ –°–ª–æ—Ç—ã', roulette: 'üé° –†—É–ª–µ—Ç–∫–∞' };
            const entry = {
                game: gameNames[game],
                bet: betAmount,
                win: winAmount,
                isWin: isWin,
                time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })
            };
            
            history.unshift(entry);
            if (history.length > 20) history.pop();
            
            renderHistory();
        }
        
        function renderHistory() {
            const container = document.getElementById('history-list');
            
            if (history.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –°—ã–≥—Ä–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∏–≥—Ä—É!</p>';
                return;
            }
            
            container.innerHTML = history.map(item => `
                <div class="history-item ${item.isWin ? 'history-win' : 'history-lose'} bg-[#2d2d44] rounded-xl p-3 pl-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-semibold">${item.game}</p>
                            <p class="text-xs text-gray-400">–°—Ç–∞–≤–∫–∞: ${item.bet.toLocaleString()} üíé</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${item.isWin ? 'text-green-400' : 'text-red-400'}">
                                ${item.isWin ? '+' + item.win.toLocaleString() : '-' + item.bet.toLocaleString()} üíé
                            </p>
                            <p class="text-xs text-gray-400">${item.time}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Tabs
        function showTab(tab) {
            document.querySelectorAll('.game-section').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab + '-game').classList.remove('hidden');
            
            document.querySelectorAll('[id^="tab-"]').forEach(el => {
                el.classList.remove('tab-active');
                el.classList.add('text-gray-400');
            });
            document.getElementById('tab-' + tab).classList.add('tab-active');
            document.getElementById('tab-' + tab).classList.remove('text-gray-400');
            
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active');
                el.classList.add('text-gray-400');
            });
            const navItem = document.getElementById('nav-' + tab);
            if (navItem) {
                navItem.classList.add('active');
                navItem.classList.remove('text-gray-400');
            }
        }
        
        // Bonus
        function addBonus() {
            const now = Date.now();
            const cooldown = 60000; // 1 minute
            
            if (now - lastBonusTime < cooldown) {
                const remaining = Math.ceil((cooldown - (now - lastBonusTime)) / 1000);
                showNotification(`–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ ${remaining} —Å–µ–∫ ‚è∞`, 'error');
                return;
            }
            
            const bonusAmount = 1000;
            balance += bonusAmount;
            lastBonusTime = now;
            updateBalance();
            createCoinRain();
            showNotification(`–ë–æ–Ω—É—Å +${bonusAmount} üíé –ø–æ–ª—É—á–µ–Ω!`, 'success');
            
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.notificationOccurred('success');
            }
        }
        
        // Notification
        function showNotification(message, type) {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            const notification = document.createElement('div');
            notification.className = `notification fixed top-20 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl font-semibold z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 2500);
        }
        
        // Initial setup
        selectRouletteColor('red');
    </script>
</body>
</html>
