<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>UA Temshik Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@300;500;700;800&display=swap');
        
        :root {
            --primary: #5d5fef; --accent: #a5a6f6; --gold: #ffcf52;
            --bg: #0d0e12; --card-bg: #16171d;
            --success: #4ade80; --danger: #f87171;
            --energy: #00d1ff;
        }

        body {
            margin: 0; background: var(--bg); color: #ffffff;
            font-family: 'Manrope', sans-serif; overflow: hidden;
            height: 100vh; display: flex; flex-direction: column;
        }

        .header {
            padding: 45px 25px 20px; background: rgba(13, 14, 18, 0.9);
            backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255,255,255,0.05);
            text-align: center;
        }
        .balance { font-size: 38px; font-weight: 800; color: #fff; margin-bottom: 15px; }
        .balance span { color: var(--gold); }

        /* –®–∫–∞–ª–∞ –ï–Ω–µ—Ä–≥—ñ—ó */
        .energy-container { width: 100%; background: rgba(255,255,255,0.05); height: 12px; border-radius: 10px; overflow: hidden; position: relative; }
        .energy-fill { height: 100%; background: var(--energy); width: 100%; transition: width 0.3s ease; box-shadow: 0 0 10px var(--energy); }
        .energy-text { position: absolute; width: 100%; text-align: center; font-size: 9px; font-weight: 800; line-height: 12px; color: #fff; text-shadow: 0 1px 2px #000; }

        .viewport { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 120px; }
        .tab { display: none; }
        .tab.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .section-h { font-size: 16px; font-weight: 800; margin: 20px 0 15px; display: flex; justify-content: space-between; align-items: center; }

        .card {
            background: var(--card-bg); border-radius: 20px; padding: 16px;
            margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.03);
            display: flex; justify-content: space-between; align-items: center;
        }
        .card-info h3 { margin: 0; font-size: 15px; font-weight: 700; }
        .card-info p { margin: 4px 0 0; font-size: 12px; color: #828282; }

        .action-btn {
            background: var(--primary); color: white; border: none; padding: 10px 16px;
            border-radius: 14px; font-weight: 700; font-size: 13px; transition: 0.2s;
        }
        .action-btn:active { transform: scale(0.95); }
        .action-btn:disabled { background: #25262b; color: #555; opacity: 0.6; }

        .nav {
            position: fixed; bottom: 25px; left: 20px; right: 20px;
            background: rgba(22, 23, 29, 0.95); border-radius: 24px; height: 70px; 
            display: flex; justify-content: space-around; align-items: center; border: 1px solid rgba(255,255,255,0.1);
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; font-size: 10px; font-weight: 700; }
        .nav-item.active { color: var(--primary); }

        .log { background: rgba(0,0,0,0.2); border-radius: 15px; padding: 12px; font-size: 11px; height: 80px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.05); }
        .log-item { margin-bottom: 5px; padding-left: 8px; border-left: 2px solid var(--primary); }
    </style>
</head>
<body>

    <div class="header">
        <div class="balance" id="balance">0<span>‚Ç¥</span></div>
        <div class="energy-container">
            <div class="energy-fill" id="energy-bar"></div>
            <div class="energy-text">–ï–ù–ï–†–ì–Ü–Ø: <span id="energy-val">100</span>%</div>
        </div>
    </div>

    <div class="viewport">
        <div id="tab-work" class="tab active">
            <div class="section-h">üöÄ –¢–ï–ú–ö–ò</div>
            <div id="temki-list"></div>
            
            <div class="section-h">ü•Ø –ü–ï–†–ï–ö–£–°–ò–¢–ò (–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è)</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="card" style="margin-bottom:0; flex-direction:column; align-items:flex-start; gap:8px;">
                    <div class="card-info"><h3>‚òïÔ∏è –ö–∞–≤–∞</h3><p>50 ‚Ç¥ | +20‚ö°</p></div>
                    <button class="action-btn" style="width:100%" onclick="eat(50, 20)">–ü–∏—Ç–∏</button>
                </div>
                <div class="card" style="margin-bottom:0; flex-direction:column; align-items:flex-start; gap:8px;">
                    <div class="card-info"><h3>üçî –®–∞—É—Ä–º–∞</h3><p>150 ‚Ç¥ | +60‚ö°</p></div>
                    <button class="action-btn" style="width:100%" onclick="eat(150, 60)">–á—Å—Ç–∏</button>
                </div>
            </div>

            <div class="section-h">üßæ –õ–û–ì</div>
            <div class="log" id="terminal"></div>
        </div>

        <div id="tab-crypto" class="tab">
            <div class="section-h">üìà BTC / UAH</div>
            <div class="card" style="flex-direction:column; align-items:center;">
                <div id="btc-price" style="font-size:24px; font-weight:800; color:var(--success);">‚Ç¥ 2,800,000</div>
                <canvas id="cryptoChart" style="width:100%; height:120px;"></canvas>
            </div>
            <div class="card">
                <div class="card-info"><h3>–ì–∞–º–∞–Ω–µ—Ü—å</h3><p><span id="my-btc">0</span> BTC</p></div>
                <button class="action-btn" onclick="tradeBtc('all_sell')" style="background:#fff; color:#000">–ü–†–û–î–ê–¢–ò –í–°–ï</button>
            </div>
            <button class="action-btn" style="width:100%; background:var(--gold); color:#000" onclick="tradeBtc('all_buy')">–ó–ê–ö–†–£–¢–ò–¢–ò –í–°–ï –í BTC</button>
        </div>

        <div id="tab-shop" class="tab">
            <div class="section-h">üèéÔ∏è –ê–ö–¢–ò–í–ò</div>
            <div id="shop-list"></div>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showTab('work', this)"><span>üí∏</span>–¢–ï–ú–ö–ò</div>
        <div class="nav-item" onclick="showTab('crypto', this)"><span>üìä</span>–ö–†–ò–ü–¢–ê</div>
        <div class="nav-item" onclick="showTab('shop', this)"><span>üè†</span>–ú–ê–ô–ù–û</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let money = Number(localStorage.getItem('money')) || 1000;
        let btcCount = Number(localStorage.getItem('btcCount')) || 0;
        let energy = Number(localStorage.getItem('energy')) || 100;
        let btcPrice = 2850000;
        let priceHistory = [2850000, 2800000, 2870000];
        let ownedItems = JSON.parse(localStorage.getItem('ownedItems')) || [];

        const temki = [
            { id: 1, name: "–î—Ä–æ–ø –Ω–∞ –ü—Ä–æ–º", cost: 200, min: 20, max: 150, energy: 15 },
            { id: 2, name: "–ü–µ—Ä–µ–ø—Ä–æ–¥–∞–∂ iPhone", cost: 15000, min: 1000, max: 5000, energy: 30 },
            { id: 3, name: "–°–∫–∞–º –º–∞–º–æ–Ω—Ç—ñ–≤", cost: 0, min: -5000, max: 20000, energy: 50 }
        ];

        function save() {
            localStorage.setItem('money', money);
            localStorage.setItem('btcCount', btcCount);
            localStorage.setItem('energy', energy);
            localStorage.setItem('ownedItems', JSON.stringify(ownedItems));
        }

        // –ê–≤—Ç–æ-–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –µ–Ω–µ—Ä–≥—ñ—ó (1% –∫–æ–∂–Ω—ñ 5 —Å–µ–∫)
        setInterval(() => {
            if(energy < 100) {
                energy = Math.min(100, energy + 1);
                updateUI();
            }
        }, 5000);

        function updateUI() {
            document.getElementById('balance').innerHTML = Math.floor(money).toLocaleString() + '<span>‚Ç¥</span>';
            document.getElementById('my-btc').textContent = btcCount.toFixed(6);
            document.getElementById('energy-val').textContent = Math.floor(energy);
            document.getElementById('energy-bar').style.width = energy + '%';

            // –°–ø–∏—Å–æ–∫ —Ç–µ–º–æ–∫
            const tList = document.getElementById('temki-list');
            tList.innerHTML = '';
            temki.forEach(t => {
                tList.innerHTML += `<div class="card">
                    <div class="card-info"><h3>${t.name}</h3><p>${t.cost} ‚Ç¥ | -${t.energy}‚ö°</p></div>
                    <button class="action-btn" onclick="work(${t.id})" ${(money < t.cost || energy < t.energy) ? 'disabled' : ''}>–í–û–†–í–ê–¢–ò–°–¨</button>
                </div>`;
            });
            save();
        }

        function work(id) {
            const t = temki.find(x => x.id === id);
            if(energy < t.energy) return;

            energy -= t.energy;
            money -= t.cost;

            let profit = Math.floor(Math.random() * (t.max - t.min + 1)) + t.min;
            money += (t.cost + profit);
            
            addLog(profit >= 0 ? `–ü—Ä–æ—Ñ—ñ—Ç: +${profit} ‚Ç¥` : `–ú—ñ–Ω—É—Å: ${profit} ‚Ç¥`, profit >= 0 ? 'var(--success)' : 'var(--danger)');
            tg.HapticFeedback.impactOccurred('medium');
            updateUI();
        }

        function eat(cost, val) {
            if(money >= cost && energy < 100) {
                money -= cost;
                energy = Math.min(100, energy + val);
                addLog(`–í—ñ–¥–Ω–æ–≤–∏–≤ –µ–Ω–µ—Ä–≥—ñ—é!`, 'var(--energy)');
                tg.HapticFeedback.notificationOccurred('success');
                updateUI();
            }
        }

        function tradeBtc(type) {
            if(type === 'all_buy' && money > 0) {
                btcCount += money / btcPrice; money = 0;
            } else if(type === 'all_sell' && btcCount > 0) {
                money += btcCount * btcPrice; btcCount = 0;
            }
            updateUI();
        }

        function showTab(name, el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + name).classList.add('active');
            el.classList.add('active');
        }

        function addLog(msg, col) {
            const l = document.getElementById('terminal');
            l.insertAdjacentHTML('afterbegin', `<div class="log-item" style="border-color:${col}">${msg}</div>`);
        }

        updateUI();
    </script>
</body>
</html>
