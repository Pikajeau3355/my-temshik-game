<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>UA Temshik Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@300;500;700;800&display=swap');
        
        :root {
            --primary: #5d5fef; --accent: #a5a6f6; --gold: #ffcf52;
            --bg: #0d0e12; --card-bg: #16171d;
            --success: #4ade80; --danger: #f87171;
        }

        body {
            margin: 0; background: var(--bg); color: #ffffff;
            font-family: 'Manrope', sans-serif; overflow: hidden;
            height: 100vh; display: flex; flex-direction: column;
        }

        .header {
            padding: 50px 25px 20px; background: rgba(13, 14, 18, 0.9);
            backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255,255,255,0.05);
            text-align: center; z-index: 10;
        }
        .balance-label { font-size: 12px; color: #828282; font-weight: 500; margin-bottom: 5px; letter-spacing: 1px; }
        .balance { font-size: 38px; font-weight: 800; color: #fff; }
        .balance span { color: var(--gold); margin-left: 4px; }

        .viewport { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 120px; }
        .tab { display: none; }
        .tab.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* –°—Ç–∏–ª—å –≥—Ä–∞—Ñ–∏–∫—É */
        .chart-container {
            background: var(--card-bg); border-radius: 24px; padding: 15px;
            margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.03);
            position: relative; overflow: hidden;
        }
        canvas { width: 100%; height: 150px; }

        .card {
            background: var(--card-bg); border-radius: 20px; padding: 18px;
            margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.03);
            display: flex; justify-content: space-between; align-items: center;
        }
        .card-info h3 { margin: 0; font-size: 15px; font-weight: 700; }
        .card-info p { margin: 4px 0 0; font-size: 12px; color: #828282; }

        .btn {
            background: var(--primary); color: white; border: none; padding: 12px 18px;
            border-radius: 14px; font-weight: 700; font-size: 13px; transition: 0.2s;
        }
        .btn:active { transform: scale(0.95); }
        .btn:disabled { background: #25262b; color: #555; }

        .nav {
            position: fixed; bottom: 25px; left: 20px; right: 20px;
            background: rgba(22, 23, 29, 0.96); backdrop-filter: blur(20px);
            border-radius: 24px; height: 70px; display: flex;
            justify-content: space-around; align-items: center;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; font-size: 10px; font-weight: 700; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 22px; margin-bottom: 3px; }

        .log { background: rgba(0,0,0,0.2); border-radius: 15px; padding: 12px; font-size: 11px; height: 90px; overflow-y: auto; }
        .log-item { margin-bottom: 6px; padding-left: 10px; border-left: 2px solid var(--primary); }
    </style>
</head>
<body>

    <div class="header">
        <div class="balance-label">–ö–ê–ü–Ü–¢–ê–õ</div>
        <div class="balance" id="balance">0<span>‚Ç¥</span></div>
    </div>

    <div class="viewport">
        <div id="tab-work" class="tab active">
            <h3 style="font-size: 16px;">üöÄ –î–æ—Å—Ç—É–ø–Ω—ñ —Å—Ö–µ–º–∏</h3>
            <div id="temki-list"></div>
            <h3 style="font-size: 16px; margin-top: 20px;">üßæ –û—Å—Ç–∞–Ω–Ω—ñ –ø–æ–¥—ñ—ó</h3>
            <div class="log" id="terminal"></div>
        </div>

        <div id="tab-crypto" class="tab">
            <h3 style="font-size: 16px;">üìà BTC / UAH</h3>
            <div class="chart-container">
                <div id="btc-price-display" style="font-size: 20px; font-weight: 800; color: var(--success); margin-bottom: 10px;">‚Ç¥ 2,500,000</div>
                <canvas id="cryptoChart"></canvas>
            </div>
            
            <div class="card">
                <div class="card-info">
                    <h3>–¢–≤—ñ–π –≥–∞–º–∞–Ω–µ—Ü—å</h3>
                    <p>–î–æ—Å—Ç—É–ø–Ω–æ: <span id="my-btc" style="color:#fff; font-weight:700;">0</span> BTC</p>
                </div>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="btn" onclick="tradeBtc('buy')">–ö–£–ü–ò–¢–ò (0.01)</button>
                <button class="btn" style="background:#25262b" onclick="tradeBtc('sell')">–ü–†–û–î–ê–¢–ò (0.01)</button>
                <button class="btn" style="grid-column: span 2; background: var(--gold); color: #000;" onclick="tradeBtc('all')">–í–û–†–í–ê–¢–ò–°–¨ –ù–ê –í–°–Ü ‚Ç¥</button>
            </div>
        </div>

        <div id="tab-shop" class="tab">
            <h3 style="font-size: 16px;">üèéÔ∏è –¢–≤–æ—ó –∞–∫—Ç–∏–≤–∏</h3>
            <div id="shop-list"></div>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showTab('work', this)">
            <span class="nav-icon">üí∏</span><span>–¢–ï–ú–ö–ò</span>
        </div>
        <div class="nav-item" onclick="showTab('crypto', this)">
            <span class="nav-icon">üìä</span><span>–ö–†–ò–ü–¢–ê</span>
        </div>
        <div class="nav-item" onclick="showTab('shop', this)">
            <span class="nav-icon">üè†</span><span>–ú–ê–ô–ù–û</span>
        </div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let money = Number(localStorage.getItem('money')) || 1000;
        let exp = Number(localStorage.getItem('exp')) || 0;
        let btcCount = Number(localStorage.getItem('btcCount')) || 0;
        let btcPrice = 2800000;
        let priceHistory = [2800000, 2790000, 2810000, 2805000, 2820000];
        let ownedItems = JSON.parse(localStorage.getItem('ownedItems')) || [];

        function save() {
            localStorage.setItem('money', money);
            localStorage.setItem('exp', exp);
            localStorage.setItem('btcCount', btcCount);
            localStorage.setItem('ownedItems', JSON.stringify(ownedItems));
        }

        const temki = [
            { id: 1, name: "–î—Ä–æ–ø—à–∏–ø—ñ–Ω–≥", cost: 500, min: 50, max: 300, risk: 0.1, rank: 0 },
            { id: 2, name: "–ü–µ—Ä–µ–ø—Ä–æ–¥–∞–∂ –∞–≤—Ç–æ", cost: 50000, min: 5000, max: 20000, risk: 0.2, rank: 500 }
        ];

        const shop = [
            { id: 'iphone', name: "iPhone 15 Pro", cost: 45000, bonus: "–°—Ç–∞—Ç—É—Å +100" },
            { id: 'bmw', name: "BMW M5", cost: 500000, bonus: "+25% –¥–æ—Ö–æ–¥—É" }
        ];

        function showTab(name, el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + name).classList.add('active');
            el.classList.add('active');
            tg.HapticFeedback.selectionChanged();
            if(name === 'crypto') setTimeout(drawChart, 100);
        }

        // --- –ì–†–ê–§–Ü–ö ---
        function drawChart() {
            const canvas = document.getElementById('cryptoChart');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const max = Math.max(...priceHistory);
            const min = Math.min(...priceHistory);
            const range = max - min;
            
            ctx.beginPath();
            ctx.strokeStyle = '#4ade80';
            ctx.lineWidth = 3;
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#4ade80';

            priceHistory.forEach((p, i) => {
                const x = (i / (priceHistory.length - 1)) * canvas.width;
                const y = canvas.height - ((p - min) / range) * canvas.height;
                if(i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();
        }

        // --- –ö–†–ò–ü–¢–û –õ–û–ì–Ü–ö–ê ---
        function tradeBtc(type) {
            const amount = 0.01;
            const cost = btcPrice * amount;

            if(type === 'buy' && money >= cost) {
                money -= cost; btcCount += amount;
                addLog(`–ö—É–ø–ª–µ–Ω–æ 0.01 BTC`, 'var(--success)');
            } else if(type === 'sell' && btcCount >= amount) {
                money += cost; btcCount -= amount;
                addLog(`–ü—Ä–æ–¥–∞–Ω–æ 0.01 BTC`, 'var(--danger)');
            } else if(type === 'all' && money > 0) {
                let allAmount = money / btcPrice;
                btcCount += allAmount;
                addLog(`–í—Å—ñ –≥—Ä–æ—à—ñ –≤ BTC! (+${allAmount.toFixed(4)})`, var(--gold));
                money = 0;
            }
            tg.HapticFeedback.impactOccurred('medium');
            updateUI();
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ü—ñ–Ω–∏
        setInterval(() => {
            let change = (Math.random() - 0.5) * 60000;
            btcPrice += change;
            priceHistory.push(btcPrice);
            if(priceHistory.length > 20) priceHistory.shift();
            
            const el = document.getElementById('btc-price-display');
            if(el) {
                el.textContent = '‚Ç¥ ' + Math.floor(btcPrice).toLocaleString();
                el.style.color = change > 0 ? 'var(--success)' : 'var(--danger)';
                drawChart();
            }
        }, 3000);

        function work(id) {
            const t = temki.find(x => x.id === id);
            if(money < t.cost) return;
            money -= t.cost;
            if (Math.random() < t.risk) {
                addLog(`–°—Ö–µ–º–∞ –ø—Ä–æ–≤–∞–ª–µ–Ω–∞: -${t.cost} ‚Ç¥`, 'var(--danger)');
            } else {
                let p = Math.floor(Math.random() * (t.max - t.min + 1)) + t.min;
                money += (t.cost + p); exp += 20;
                addLog(`–ü—Ä–æ—Ñ—ñ—Ç: +${p} ‚Ç¥`, 'var(--success)');
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('balance').innerHTML = Math.floor(money).toLocaleString() + '<span>‚Ç¥</span>';
            document.getElementById('my-btc').textContent = btcCount.toFixed(4);
            
            const tList = document.getElementById('temki-list');
            tList.innerHTML = '';
            temki.forEach(t => {
                tList.innerHTML += `<div class="card">
                    <div class="card-info"><h3>${t.name}</h3><p>–¶—ñ–Ω–∞: ${t.cost} ‚Ç¥</p></div>
                    <button class="btn" onclick="work(${t.id})" ${money < t.cost ? 'disabled' : ''}>–í–û–†–í–ê–¢–ò–°–¨</button>
                </div>`;
            });
            save();
        }

        function addLog(msg, col) {
            const l = document.getElementById('terminal');
            l.insertAdjacentHTML('afterbegin', `<div class="log-item" style="border-color:${col}">${msg}</div>`);
        }

        updateUI();
    </script>
</body>
</html>
